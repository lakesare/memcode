{"version":3,"sources":["webpack:///webpack/bootstrap 438360dda834e9ef1c01","webpack:///./db/init.js","webpack:///external \"express\"","webpack:///external \"pg-promise\"","webpack:///./services/camelizeDbColumns.js","webpack:///./services/catchAsync.js","webpack:///./components/courses/model/index.js","webpack:///external \"path\"","webpack:///./components/problemsUserIsLearning/services/getNextScore.js","webpack:///./components/problemsUserIsLearning/services/initialScore.js","webpack:///./components/users/model.js","webpack:///../~/source-map-support/register.js","webpack:///./components/courses/model/ddelete.js","webpack:///./components/courses/model/insert.js","webpack:///./components/courses/model/select.js","webpack:///./components/courses/model/update.js","webpack:///./middlewares/authenticate.js","webpack:///./model/select.js","webpack:///./services/integerizeDbColumns.js","webpack:///../~/source-map-support/source-map-support.js","webpack:///external \"fs\"","webpack:///external \"module\"","webpack:///external \"source-map\"","webpack:///./components/coursesUserIsLearning/model/index.js","webpack:///./components/problems/model/index.js","webpack:///external \"jsonwebtoken\"","webpack:///./index.js","webpack:///external \"babel-polyfill\"","webpack:///./components/auth/routes.js","webpack:///./components/courses/routes.js","webpack:///./components/coursesUserIsLearning/model/insert.js","webpack:///./components/coursesUserIsLearning/model/select.js","webpack:///./components/coursesUserIsLearning/model/update.js","webpack:///./components/coursesUserIsLearning/routes.js","webpack:///./components/pages/routes.js","webpack:///./components/problems/model/insert.js","webpack:///./components/problems/model/select.js","webpack:///./components/problems/routes.js","webpack:///./components/problemsUserIsLearning/model/index.js","webpack:///./middlewares/allowCrossDomain.js","webpack:///./middlewares/static.js","webpack:///./middlewares/stopPropagationForAssets.js","webpack:///../env.js","webpack:///external \"body-parser\"","webpack:///external \"form-data\"","webpack:///external \"node-fetch\""],"names":["pgPromise","camelizeColumns","data","template","prop","camel","utils","camelize","map","d","pgOptions","query","e","cyan","console","log","receive","getConnectionString","process","env","NODE_ENV","host","port","database","user","password","DATABASE_URL","pgPackage","default","db","connect","then","obj","done","catch","error","message","camelizeHashKeys","oldHash","newHash","undefined","Object","keys","forEach","key","camelizedKey","camelizeColumnsIn","aOld","asTitlesArray","aNew","includes","camelizeDbColumns","arrayOrHash","columnTitlesArray","Array","isArray","hash","catchAsync","request","response","next","promise","asyncFunction","select","insert","update","ddelete","getNextScore","prevEasiness","prevConsecutiveCorrectAnswers","performanceRating","nextEasiness","clipEasiness","nextConsecutiveCorrectAnswers","isAnswerCorrect","daysToNextReview","clipDaysToNextReview","easiness","consecutiveCorrectAnswers","Math","max","days","min","initialScore","oneByOauth","oauthProvider","oauthId","oneOrNone","toString","createFromGithub","profile","one","id","username","login","avatarUrl","avatar_url","destroyCourseWithProblems","courseId","none","create","course","userId","title","description","ifPublic","allCreated","allLearned","all","any","array","oneForActions","oneById","values","authenticateMiddleware","headers","token","split","verify","status","json","currentUser","fetchCoursesAndTheirStats","where","orderBy","integerizeColumnsIn","parseInt","integerizeDbColumns","problem","problemId","content","destroy","app","use","get","send","req","res","PORT","listen","err","User","router","Router","append","code","method","body","ok","text","Promise","reject","stringWithAccessToken","accessToken","Authorization","accountReturnedFromGithub","existingUser","sign","redirectWithToken","createdUser","redirect","Course","courses","params","post","put","delete","oneByCourseIdAndUserId","problemsToLearn","problemsToReview","ifActive","active","CourseUserIsLearning","ProblemUserIsLearning","courseUserIsLearning","review","Problem","problems","allByCourseId","type","created_at","Date","createdProblem","updatedProblem","findByCuilIdAndProblemId","cuilId","courseUserIsLearningId","me","nextScore","allowCrossDomain","header","staticAssets","static","join","__dirname","stopPropagationForAssets","url","end"],"mappings":"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AM8E,sBAAsB,SAAtBA,mBAAsB,CAAC3E,WAAD,EAAcC,iBAAd,EAAoC;AAC9D,MAAIC,MAAMC,OAAN,CAAcH,WAAd,CAAJ,EAAgC;AAC9B,WAAOA,YAAY5C,GAAZ,CAAgB;AAAA,aACrBqH,oBAAoBrE,IAApB,EAA0BH,iBAA1B,CADqB;AAAA,KAAhB,CAAP;AAGD,GAJD,MAIO;AACL,WAAOwE,oBAAoBzE,WAApB,EAAiCC,iBAAjC,CAAP;AACD;AACF,CARD;;QAUS0E,mB,GAAAA,mB;;;;;;ACzBT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,aAAa;AACb;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6BAA6B,YAAY,kBAAkB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,2BAA2B;AAC3B;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0DAA0D,gCAAgC,EAAE;AAC5F,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,oCAAoC,wBAAwB;AAC5D,sCAAsC,sBAAsB;AAC5D,wCAAwC,4BAA4B;AACpE,iDAAiD,wBAAwB;AACzE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sCAAsC,eAAe;AACrD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 48);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 438360dda834e9ef1c01","import * as pgPromise from 'pg-promise';\n\n// for pgOptions\n/* eslint-disable */ // because it's taken from online source, may want to rewrite some time\nconst camelizeColumns = (data) => {\n  const template = data[0];\n  for (let prop in template) {\n    const camel = pgPromise.utils.camelize(prop);\n    if (!(camel in template)) {\n      data.map((d) => {\n        d[camel] = d[prop];\n        delete d[prop];\n      });\n    }\n  }\n};\n\nconst pgOptions = {\n  query: (e) => {\n    const cyan = \"\\x1b[36m%s\\x1b[0m\";\n    console.log(cyan, e.query); // log the query being executed\n  },\n  receive: (data) => {\n    camelizeColumns(data);\n  } // https://coderwall.com/p/irklcq\n};\n\nconst getConnectionString = () => {\n  switch (process.env.NODE_ENV) {\n    case 'development':\n      return {\n        host: 'localhost', // 'localhost' is the default;\n        port: 5432, // 5432 is the default;\n        database: 'memcode',\n        user: 'postgres',\n        password: '`1`1`1'\n      };\n    case 'test':\n      return {\n        host: 'localhost', // 'localhost' is the default;\n        port: 5432, // 5432 is the default;\n        database: 'memcode_test',\n        user: 'postgres',\n        password: '`1`1`1'\n      };\n    case 'production':\n      // this variable is set automatically after we do heroku addons:create heroku-postgresql:hobby-dev\n      return process.env.DATABASE_URL;\n  }\n};\n\nconst pgPackage = pgPromise.default(pgOptions);\nconst db = pgPackage(getConnectionString());\ndb.connect()\n  .then((obj) => {\n    obj.done(); // success, release the connection;\n  })\n  .catch((error) => {\n    console.log(\"ERROR:\", error.message || error);\n  });\n\nexport { db };\n\n\n\n// WEBPACK FOOTER //\n// ./db/init.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"pg-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"pg-promise\"\n// module id = 2\n// module chunks = 0 1","import { utils } from 'pg-promise';\n\nconst camelizeHashKeys = (oldHash) => {\n  const newHash = {};\n  if (oldHash === undefined || oldHash === null) return null;\n  Object.keys(oldHash).forEach((key) => {\n    const camelizedKey = utils.camelize(key);\n    newHash[camelizedKey] = oldHash[key];\n  });\n  return newHash;\n};\n\n// a{ courseUserIsLearning: b{ wow_yes: 1 }, amountOfProblems: 3 }\nconst camelizeColumnsIn = (aOld, asTitlesArray) => {\n  const aNew = {};\n\n  Object.keys(aOld).forEach((key) => {\n    asTitlesArray.includes(key) ?\n      aNew[key] = camelizeHashKeys(aOld[key]) :\n      aNew[key] = aOld[key];\n  });\n\n  return aNew;\n};\n\n// output of row_to_json doesn't get camelized, lets do it manually like so:\n// .then(array => camelizeDbColumns(array, ['course', 'courseUserIsLearning']))\n// http://stackoverflow.com/questions/33023469/node-postgres-and-getting-joined-fields-with-repeated-names\nconst camelizeDbColumns = (arrayOrHash, columnTitlesArray) => {\n  if (Array.isArray(arrayOrHash)) {\n    return arrayOrHash.map(hash =>\n      camelizeColumnsIn(hash, columnTitlesArray)\n    );\n  } else {\n    return camelizeColumnsIn(arrayOrHash, columnTitlesArray);\n  }\n};\n\nexport { camelizeDbColumns };\n\n\n\n// WEBPACK FOOTER //\n// ./services/camelizeDbColumns.js","// catch Async Await function's error\nconst catchAsync = asyncFunction =>\n  (request, response, next) => {\n    const promise = asyncFunction(request, response, next);\n    promise.catch((error) => {\n      next(error);\n    });\n  };\n\nexport { catchAsync };\n\n\n\n// WEBPACK FOOTER //\n// ./services/catchAsync.js","// CREATE TABLE course (\n//   id SERIAL PRIMARY KEY,\n//   title VARCHAR NOT NULL,\n\n//   user_id INTEGER REFERENCES \"user\" (id) ON DELETE CASCADE NOT NULL\n// );\n\nimport { select } from './select';\nimport { insert } from './insert';\nimport { update } from './update';\nimport { ddelete } from './ddelete';\n\nexport { select, insert, update, ddelete };\n\n\n\n// WEBPACK FOOTER //\n// ./components/courses/model/index.js","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 6\n// module chunks = 0 2","// ___why not use original method?\n// (http://www.blueraja.com/blog/477/a-better-spaced-repetition-learning-algorithm-sm2)\n// original method resolves into intervals too harsh:\n//\n// { days: 6 },\n// { days: 10 },\n// { days: 30 },\n// { days: 99 },\n// { days: 339 },\n// { days: 1231 },\n// { days: 4724 },\n// { days: 19128 },\n// { days: 24428 }\n\n// memrise\n//\n// 4 hours, 12 hours, 1 day, 6 days, 12 days, 24 days, 48 days, 96 days, 180 days\n\n// mine\n// [ PostgresInterval { hours: 4, minutes: 48 },\n//   PostgresInterval { days: 1, hours: 10, minutes: 59, seconds: 31 },\n//   PostgresInterval { days: 4, hours: 19, minutes: 32, seconds: 9 },\n//   PostgresInterval { days: 8, hours: 20, minutes: 47, seconds: 2 },\n//   PostgresInterval { days: 13, hours: 15, minutes: 53, seconds: 16 },\n//   PostgresInterval { days: 19, hours: 6 },\n//   PostgresInterval { days: 25, hours: 16, minutes: 16, seconds: 19 },\n//   PostgresInterval { days: 32, hours: 23, minutes: 51, seconds: 21 },\n//   PostgresInterval { days: 41, hours: 5, minutes: 54, seconds: 14 },\n//   PostgresInterval { days: 50, hours: 11, minutes: 34, seconds: 4 },\n//   PostgresInterval { days: 60, hours: 18 } ]\n\n\n// performanceRating: on a scale from 0-5 (0=worst, 5=best)\n// 0.28\nconst getNextScore = (prevEasiness, prevConsecutiveCorrectAnswers, performanceRating) => {\n  const nextEasiness = clipEasiness(\n    prevEasiness +\n    (-0.8) +\n    (0.28 * performanceRating) +\n    (-0.02 * (performanceRating ** 2))\n  );\n\n  const nextConsecutiveCorrectAnswers =\n    isAnswerCorrect(performanceRating) ?\n    prevConsecutiveCorrectAnswers + 1 :\n    0;\n\n  const daysToNextReview = clipDaysToNextReview(\n    isAnswerCorrect(performanceRating) ?\n    // 6 * (nextEasiness ** (nextConsecutiveCorrectAnswers - 1)) :\n    0.2 + (0.2 * ((nextEasiness ** 2.2) * ((nextConsecutiveCorrectAnswers - 1) ** 2.2))) :\n    1\n  );\n\n  return {\n    easiness: nextEasiness,\n    consecutiveCorrectAnswers: nextConsecutiveCorrectAnswers,\n    daysToNextReview\n  };\n};\n\nconst isAnswerCorrect = (performanceRating) => performanceRating >= 4;\n\n// easiness must be >= 1.3\n// if it's smaller - make it 1.3\nconst clipEasiness = (easiness) => Math.max(easiness, 1.3);\n\nconst clipDaysToNextReview = (days) => Math.min(days, 300);\n\nexport { getNextScore };\n\n\n\n// WEBPACK FOOTER //\n// ./components/problemsUserIsLearning/services/getNextScore.js","const initialScore = () => ({\n  easiness: 2.5,\n  consecutiveCorrectAnswers: 0\n});\n\nexport { initialScore };\n\n\n\n// WEBPACK FOOTER //\n// ./components/problemsUserIsLearning/services/initialScore.js","import { db } from '~/db/init.js';\n\nconst select = {\n  // getUserByOauth('github', 7578559)\n  // => user\n  oneByOauth: (oauthProvider, oauthId) =>\n    db.oneOrNone(\n      'SELECT * FROM \"user\" where oauth_provider=${oauthProvider} and oauth_id=${oauthId}',\n      {\n        oauthProvider,\n        oauthId: oauthId.toString()\n      }\n    )\n};\n\nconst insert = {\n  createFromGithub: (profile) =>\n    db.one(\n      'INSERT INTO \"user\" (oauth_provider, oauth_id, username, avatar_url) VALUES (${oauthProvider}, ${oauthId}, ${username}, ${avatarUrl}) RETURNING *',\n      {\n        oauthProvider: 'github',\n        oauthId: profile.id.toString(),\n        username: profile.login,\n        avatarUrl: profile.avatar_url\n      }\n    )\n};\n\nexport { select, insert };\n\n\n\n// WEBPACK FOOTER //\n// ./components/users/model.js","require('./').install();\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../~/source-map-support/register.js\n// module id = 10\n// module chunks = 0 2","import { db } from '~/db/init.js';\n\nconst ddelete = {\n  // will delete all problems of this course and all course_user_is_learning\n  destroyCourseWithProblems: (courseId) =>\n    db.none('DELETE FROM course WHERE id=${courseId}', { courseId })\n};\n\nexport { ddelete };\n\n\n\n// WEBPACK FOOTER //\n// ./components/courses/model/ddelete.js","import { db } from '~/db/init.js';\n\nconst insert = {\n  create: (course, userId) =>\n    db.one(\n      'INSERT INTO course (title, description, if_public, user_id) \\\n      VALUES (${title}, ${description}, ${ifPublic}, ${userId}) RETURNING *',\n      {\n        title: course.title,\n        description: course.description,\n        ifPublic: course.ifPublic,\n        userId\n      }\n    )\n};\n\nexport { insert };\n\n\n\n// WEBPACK FOOTER //\n// ./components/courses/model/insert.js","import { db } from '~/db/init.js';\nimport { camelizeDbColumns } from '~/services/camelizeDbColumns';\n\nimport { fetchCoursesAndTheirStats } from '~/model/select';\n\nconst select = {\n  allCreated: (userId) =>\n    fetchCoursesAndTheirStats(`WHERE course.user_id = \\${userId}`, '', userId),\n\n  // for /profile. returns all courses userId is currently learning.\n  // only active,\n  // filtered by amount of due problems (TODO)\n  allLearned: (userId) =>\n    fetchCoursesAndTheirStats(`\n      WHERE course_user_is_learning.user_id = \\${userId} AND course_user_is_learning.active = true\n      `,\n      'ORDER BY amount_of_problems_to_review DESC',\n      userId\n    ),\n\n  all: () =>\n    db.any(\n      `SELECT\n        row_to_json(course.*) AS course,\n        COUNT(problem.id)     AS amount_of_problems\n      FROM course\n      LEFT OUTER JOIN problem ON problem.course_id = course.id\n      WHERE if_public = true\n      GROUP BY course.id\n      `,\n    )\n      .then(array => camelizeDbColumns(array, ['course', 'courseUserIsLearning'])),\n\n  oneForActions: (id, userId) =>\n    fetchCoursesAndTheirStats(`WHERE course.id = ${id}`, '', userId)\n      .then((array) => array[0]),\n\n  oneById: (id) =>\n    db.one(\n      `\n      SELECT *\n      FROM course\n      WHERE course.id = \\${id}\n      `,\n      { id }\n    )\n};\n\nexport { select };\n\n\n\n// WEBPACK FOOTER //\n// ./components/courses/model/select.js","import { db } from '~/db/init.js';\n\nconst update = {\n  update: (id, values) =>\n    db.one(\n      `\n      UPDATE course\n      SET title = \\${title},\n          description = \\${description},\n          if_public = \\${ifPublic}\n      WHERE id = \\${id}\n      RETURNING *\n      `,\n      {\n        ...values,\n        id\n      }\n    )\n};\n\nexport { update };\n\n\n\n// WEBPACK FOOTER //\n// ./components/courses/model/update.js","import jwt from 'jsonwebtoken';\n\n// make request.currentUser available\n// request.currentUser.oauthId,\n// request.currentUser.oauthProvider\nconst authenticateMiddleware = (request, response, next) => {\n  if (request.headers['authorization']) {\n    const token = request.headers['authorization'].split('Bearer ')[1];\n    jwt.verify(token, process.env['JWT_SECRET'], (error, user) => {\n      if (error) {\n        response.status(401).json({ error });\n      } else {\n        // eslint-disable-next-line\n        request.currentUser = user;\n        next();\n      }\n    });\n  } else {\n    response.status(401).json({ error: \"No authorization header provided\" });\n  }\n};\n\nexport { authenticateMiddleware };\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/authenticate.js","import { db } from '~/db/init.js';\nimport { camelizeDbColumns } from '~/services/camelizeDbColumns';\nimport { integerizeDbColumns } from '~/services/integerizeDbColumns';\n\n// fetch course, courseUserAndLearning etc if it exists\n//\n// problemsToReview - later.\n//   basically problem_user_is_learning with nextDueDate < Time.now\n// problemsToLearn\n//   all problems of this course MINUS learned problem_user_is_learning of this course\n//\n// => [{\n//   course,\n//   courseUserIsLearning,\n//   amountOfProblemsToReview: 3,\n//   amountOfProblemsToLearn: 2,\n// }]\nconst fetchCoursesAndTheirStats = (where, orderBy, userId) =>\n  db.any(\n    `SELECT\n      row_to_json(course.*)                  AS course,\n      row_to_json(course_user_is_learning.*) AS course_user_is_learning,\n      COUNT(distinct problem_user_is_learning.id) AS amount_of_problems_to_review,\n      (\n        (SELECT COUNT(problem.*) FROM problem WHERE problem.course_id = course.id) -\n        (SELECT COUNT(problem_user_is_learning.*) FROM problem_user_is_learning WHERE problem_user_is_learning.course_user_is_learning_id = course_user_is_learning.id)\n      )                                      AS amount_of_problems_to_learn,\n      COUNT(distinct problem.id)             AS amount_of_problems\n\n    FROM course\n\n    -- course_user_is_learning\n    LEFT OUTER JOIN course_user_is_learning\n      ON (\n        course_user_is_learning.course_id = course.id\n        AND\n        course_user_is_learning.user_id = \\${userId}\n      )\n\n    -- amount_of_problems_to_review\n    LEFT OUTER JOIN problem_user_is_learning\n      ON (\n        course_user_is_learning.id = problem_user_is_learning.course_user_is_learning_id\n        AND\n        problem_user_is_learning.next_due_date < timezone('UTC', now())\n      )\n\n    -- amount_of_problems\n    LEFT OUTER JOIN problem ON problem.course_id = course.id\n\n    ${where}\n\n    GROUP BY course_user_is_learning.id, course.id\n    \n    ${orderBy}\n    `,\n    { userId }\n  )\n    .then(array => camelizeDbColumns(array, ['course', 'courseUserIsLearning']))\n    .then(array => integerizeDbColumns(array, ['amountOfProblemsToReview', 'amountOfProblemsToLearn', 'amountOfProblems']));\n\nexport { fetchCoursesAndTheirStats };\n\n\n\n// WEBPACK FOOTER //\n// ./model/select.js","// a{ courseUserIsLearning: b{ wow_yes: 1 }, amountOfProblems: 3 }\nconst integerizeColumnsIn = (aOld, asTitlesArray) => {\n  const aNew = {};\n\n  Object.keys(aOld).forEach((key) => {\n    asTitlesArray.includes(key) ?\n      aNew[key] = parseInt(aOld[key], 10) :\n      aNew[key] = aOld[key];\n  });\n\n  return aNew;\n};\n\n// https://github.com/vitaly-t/pg-promise/issues/118\n// COUNT(3) => to return js integer instead of string\nconst integerizeDbColumns = (arrayOrHash, columnTitlesArray) => {\n  if (Array.isArray(arrayOrHash)) {\n    return arrayOrHash.map(hash =>\n      integerizeColumnsIn(hash, columnTitlesArray)\n    );\n  } else {\n    return integerizeColumnsIn(arrayOrHash, columnTitlesArray);\n  }\n};\n\nexport { integerizeDbColumns };\n\n\n\n// WEBPACK FOOTER //\n// ./services/integerizeDbColumns.js","var SourceMapConsumer = require('source-map').SourceMapConsumer;\nvar path = require('path');\n\nvar fs;\ntry {\n  fs = require('fs');\n  if (!fs.existsSync || !fs.readFileSync) {\n    // fs doesn't have all methods we need\n    fs = null;\n  }\n} catch (err) {\n  /* nop */\n}\n\n// Only install once if called multiple times\nvar errorFormatterInstalled = false;\nvar uncaughtShimInstalled = false;\n\n// If true, the caches are reset before a stack trace formatting operation\nvar emptyCacheBetweenOperations = false;\n\n// Supports {browser, node, auto}\nvar environment = \"auto\";\n\n// Maps a file path to a string containing the file contents\nvar fileContentsCache = {};\n\n// Maps a file path to a source map for that file\nvar sourceMapCache = {};\n\n// Regex for detecting source maps\nvar reSourceMap = /^data:application\\/json[^,]+base64,/;\n\n// Priority list of retrieve handlers\nvar retrieveFileHandlers = [];\nvar retrieveMapHandlers = [];\n\nfunction isInBrowser() {\n  if (environment === \"browser\")\n    return true;\n  if (environment === \"node\")\n    return false;\n  return ((typeof window !== 'undefined') && (typeof XMLHttpRequest === 'function') && !(window.require && window.module && window.process && window.process.type === \"renderer\"));\n}\n\nfunction hasGlobalProcessEventEmitter() {\n  return ((typeof process === 'object') && (process !== null) && (typeof process.on === 'function'));\n}\n\nfunction handlerExec(list) {\n  return function(arg) {\n    for (var i = 0; i < list.length; i++) {\n      var ret = list[i](arg);\n      if (ret) {\n        return ret;\n      }\n    }\n    return null;\n  };\n}\n\nvar retrieveFile = handlerExec(retrieveFileHandlers);\n\nretrieveFileHandlers.push(function(path) {\n  // Trim the path to make sure there is no extra whitespace.\n  path = path.trim();\n  if (path in fileContentsCache) {\n    return fileContentsCache[path];\n  }\n\n  var contents = null;\n  if (!fs) {\n    // Use SJAX if we are in the browser\n    var xhr = new XMLHttpRequest();\n    xhr.open('GET', path, false);\n    xhr.send(null);\n    var contents = null\n    if (xhr.readyState === 4 && xhr.status === 200) {\n      contents = xhr.responseText\n    }\n  } else if (fs.existsSync(path)) {\n    // Otherwise, use the filesystem\n    contents = fs.readFileSync(path, 'utf8');\n  }\n\n  return fileContentsCache[path] = contents;\n});\n\n// Support URLs relative to a directory, but be careful about a protocol prefix\n// in case we are in the browser (i.e. directories may start with \"http://\")\nfunction supportRelativeURL(file, url) {\n  if (!file) return url;\n  var dir = path.dirname(file);\n  var match = /^\\w+:\\/\\/[^\\/]*/.exec(dir);\n  var protocol = match ? match[0] : '';\n  return protocol + path.resolve(dir.slice(protocol.length), url);\n}\n\nfunction retrieveSourceMapURL(source) {\n  var fileData;\n\n  if (isInBrowser()) {\n     try {\n       var xhr = new XMLHttpRequest();\n       xhr.open('GET', source, false);\n       xhr.send(null);\n       fileData = xhr.readyState === 4 ? xhr.responseText : null;\n\n       // Support providing a sourceMappingURL via the SourceMap header\n       var sourceMapHeader = xhr.getResponseHeader(\"SourceMap\") ||\n                             xhr.getResponseHeader(\"X-SourceMap\");\n       if (sourceMapHeader) {\n         return sourceMapHeader;\n       }\n     } catch (e) {\n     }\n  }\n\n  // Get the URL of the source map\n  fileData = retrieveFile(source);\n  var re = /(?:\\/\\/[@#][ \\t]+sourceMappingURL=([^\\s'\"]+?)[ \\t]*$)|(?:\\/\\*[@#][ \\t]+sourceMappingURL=([^\\*]+?)[ \\t]*(?:\\*\\/)[ \\t]*$)/mg;\n  // Keep executing the search to find the *last* sourceMappingURL to avoid\n  // picking up sourceMappingURLs from comments, strings, etc.\n  var lastMatch, match;\n  while (match = re.exec(fileData)) lastMatch = match;\n  if (!lastMatch) return null;\n  return lastMatch[1];\n};\n\n// Can be overridden by the retrieveSourceMap option to install. Takes a\n// generated source filename; returns a {map, optional url} object, or null if\n// there is no source map.  The map field may be either a string or the parsed\n// JSON object (ie, it must be a valid argument to the SourceMapConsumer\n// constructor).\nvar retrieveSourceMap = handlerExec(retrieveMapHandlers);\nretrieveMapHandlers.push(function(source) {\n  var sourceMappingURL = retrieveSourceMapURL(source);\n  if (!sourceMappingURL) return null;\n\n  // Read the contents of the source map\n  var sourceMapData;\n  if (reSourceMap.test(sourceMappingURL)) {\n    // Support source map URL as a data url\n    var rawData = sourceMappingURL.slice(sourceMappingURL.indexOf(',') + 1);\n    sourceMapData = new Buffer(rawData, \"base64\").toString();\n    sourceMappingURL = source;\n  } else {\n    // Support source map URLs relative to the source URL\n    sourceMappingURL = supportRelativeURL(source, sourceMappingURL);\n    sourceMapData = retrieveFile(sourceMappingURL);\n  }\n\n  if (!sourceMapData) {\n    return null;\n  }\n\n  return {\n    url: sourceMappingURL,\n    map: sourceMapData\n  };\n});\n\nfunction mapSourcePosition(position) {\n  var sourceMap = sourceMapCache[position.source];\n  if (!sourceMap) {\n    // Call the (overrideable) retrieveSourceMap function to get the source map.\n    var urlAndMap = retrieveSourceMap(position.source);\n    if (urlAndMap) {\n      sourceMap = sourceMapCache[position.source] = {\n        url: urlAndMap.url,\n        map: new SourceMapConsumer(urlAndMap.map)\n      };\n\n      // Load all sources stored inline with the source map into the file cache\n      // to pretend like they are already loaded. They may not exist on disk.\n      if (sourceMap.map.sourcesContent) {\n        sourceMap.map.sources.forEach(function(source, i) {\n          var contents = sourceMap.map.sourcesContent[i];\n          if (contents) {\n            var url = supportRelativeURL(sourceMap.url, source);\n            fileContentsCache[url] = contents;\n          }\n        });\n      }\n    } else {\n      sourceMap = sourceMapCache[position.source] = {\n        url: null,\n        map: null\n      };\n    }\n  }\n\n  // Resolve the source URL relative to the URL of the source map\n  if (sourceMap && sourceMap.map) {\n    var originalPosition = sourceMap.map.originalPositionFor(position);\n\n    // Only return the original position if a matching line was found. If no\n    // matching line is found then we return position instead, which will cause\n    // the stack trace to print the path and line for the compiled file. It is\n    // better to give a precise location in the compiled file than a vague\n    // location in the original file.\n    if (originalPosition.source !== null) {\n      originalPosition.source = supportRelativeURL(\n        sourceMap.url, originalPosition.source);\n      return originalPosition;\n    }\n  }\n\n  return position;\n}\n\n// Parses code generated by FormatEvalOrigin(), a function inside V8:\n// https://code.google.com/p/v8/source/browse/trunk/src/messages.js\nfunction mapEvalOrigin(origin) {\n  // Most eval() calls are in this format\n  var match = /^eval at ([^(]+) \\((.+):(\\d+):(\\d+)\\)$/.exec(origin);\n  if (match) {\n    var position = mapSourcePosition({\n      source: match[2],\n      line: +match[3],\n      column: match[4] - 1\n    });\n    return 'eval at ' + match[1] + ' (' + position.source + ':' +\n      position.line + ':' + (position.column + 1) + ')';\n  }\n\n  // Parse nested eval() calls using recursion\n  match = /^eval at ([^(]+) \\((.+)\\)$/.exec(origin);\n  if (match) {\n    return 'eval at ' + match[1] + ' (' + mapEvalOrigin(match[2]) + ')';\n  }\n\n  // Make sure we still return useful information if we didn't find anything\n  return origin;\n}\n\n// This is copied almost verbatim from the V8 source code at\n// https://code.google.com/p/v8/source/browse/trunk/src/messages.js. The\n// implementation of wrapCallSite() used to just forward to the actual source\n// code of CallSite.prototype.toString but unfortunately a new release of V8\n// did something to the prototype chain and broke the shim. The only fix I\n// could find was copy/paste.\nfunction CallSiteToString() {\n  var fileName;\n  var fileLocation = \"\";\n  if (this.isNative()) {\n    fileLocation = \"native\";\n  } else {\n    fileName = this.getScriptNameOrSourceURL();\n    if (!fileName && this.isEval()) {\n      fileLocation = this.getEvalOrigin();\n      fileLocation += \", \";  // Expecting source position to follow.\n    }\n\n    if (fileName) {\n      fileLocation += fileName;\n    } else {\n      // Source code does not originate from a file and is not native, but we\n      // can still get the source position inside the source string, e.g. in\n      // an eval string.\n      fileLocation += \"<anonymous>\";\n    }\n    var lineNumber = this.getLineNumber();\n    if (lineNumber != null) {\n      fileLocation += \":\" + lineNumber;\n      var columnNumber = this.getColumnNumber();\n      if (columnNumber) {\n        fileLocation += \":\" + columnNumber;\n      }\n    }\n  }\n\n  var line = \"\";\n  var functionName = this.getFunctionName();\n  var addSuffix = true;\n  var isConstructor = this.isConstructor();\n  var isMethodCall = !(this.isToplevel() || isConstructor);\n  if (isMethodCall) {\n    var typeName = this.getTypeName();\n    // Fixes shim to be backward compatable with Node v0 to v4\n    if (typeName === \"[object Object]\") {\n      typeName = \"null\";\n    }\n    var methodName = this.getMethodName();\n    if (functionName) {\n      if (typeName && functionName.indexOf(typeName) != 0) {\n        line += typeName + \".\";\n      }\n      line += functionName;\n      if (methodName && functionName.indexOf(\".\" + methodName) != functionName.length - methodName.length - 1) {\n        line += \" [as \" + methodName + \"]\";\n      }\n    } else {\n      line += typeName + \".\" + (methodName || \"<anonymous>\");\n    }\n  } else if (isConstructor) {\n    line += \"new \" + (functionName || \"<anonymous>\");\n  } else if (functionName) {\n    line += functionName;\n  } else {\n    line += fileLocation;\n    addSuffix = false;\n  }\n  if (addSuffix) {\n    line += \" (\" + fileLocation + \")\";\n  }\n  return line;\n}\n\nfunction cloneCallSite(frame) {\n  var object = {};\n  Object.getOwnPropertyNames(Object.getPrototypeOf(frame)).forEach(function(name) {\n    object[name] = /^(?:is|get)/.test(name) ? function() { return frame[name].call(frame); } : frame[name];\n  });\n  object.toString = CallSiteToString;\n  return object;\n}\n\nfunction wrapCallSite(frame) {\n  if(frame.isNative()) {\n    return frame;\n  }\n\n  // Most call sites will return the source file from getFileName(), but code\n  // passed to eval() ending in \"//# sourceURL=...\" will return the source file\n  // from getScriptNameOrSourceURL() instead\n  var source = frame.getFileName() || frame.getScriptNameOrSourceURL();\n  if (source) {\n    var line = frame.getLineNumber();\n    var column = frame.getColumnNumber() - 1;\n\n    // Fix position in Node where some (internal) code is prepended.\n    // See https://github.com/evanw/node-source-map-support/issues/36\n    if (line === 1 && !isInBrowser() && !frame.isEval()) {\n      column -= 62;\n    }\n\n    var position = mapSourcePosition({\n      source: source,\n      line: line,\n      column: column\n    });\n    frame = cloneCallSite(frame);\n    frame.getFileName = function() { return position.source; };\n    frame.getLineNumber = function() { return position.line; };\n    frame.getColumnNumber = function() { return position.column + 1; };\n    frame.getScriptNameOrSourceURL = function() { return position.source; };\n    return frame;\n  }\n\n  // Code called using eval() needs special handling\n  var origin = frame.isEval() && frame.getEvalOrigin();\n  if (origin) {\n    origin = mapEvalOrigin(origin);\n    frame = cloneCallSite(frame);\n    frame.getEvalOrigin = function() { return origin; };\n    return frame;\n  }\n\n  // If we get here then we were unable to change the source position\n  return frame;\n}\n\n// This function is part of the V8 stack trace API, for more info see:\n// http://code.google.com/p/v8/wiki/JavaScriptStackTraceApi\nfunction prepareStackTrace(error, stack) {\n  if (emptyCacheBetweenOperations) {\n    fileContentsCache = {};\n    sourceMapCache = {};\n  }\n\n  return error + stack.map(function(frame) {\n    return '\\n    at ' + wrapCallSite(frame);\n  }).join('');\n}\n\n// Generate position and snippet of original source with pointer\nfunction getErrorSource(error) {\n  var match = /\\n    at [^(]+ \\((.*):(\\d+):(\\d+)\\)/.exec(error.stack);\n  if (match) {\n    var source = match[1];\n    var line = +match[2];\n    var column = +match[3];\n\n    // Support the inline sourceContents inside the source map\n    var contents = fileContentsCache[source];\n\n    // Support files on disk\n    if (!contents && fs && fs.existsSync(source)) {\n      contents = fs.readFileSync(source, 'utf8');\n    }\n\n    // Format the line from the original source code like node does\n    if (contents) {\n      var code = contents.split(/(?:\\r\\n|\\r|\\n)/)[line - 1];\n      if (code) {\n        return source + ':' + line + '\\n' + code + '\\n' +\n          new Array(column).join(' ') + '^';\n      }\n    }\n  }\n  return null;\n}\n\nfunction printErrorAndExit (error) {\n  var source = getErrorSource(error);\n\n  if (source) {\n    console.error();\n    console.error(source);\n  }\n\n  console.error(error.stack);\n  process.exit(1);\n}\n\nfunction shimEmitUncaughtException () {\n  var origEmit = process.emit;\n\n  process.emit = function (type) {\n    if (type === 'uncaughtException') {\n      var hasStack = (arguments[1] && arguments[1].stack);\n      var hasListeners = (this.listeners(type).length > 0);\n\n      if (hasStack && !hasListeners) {\n        return printErrorAndExit(arguments[1]);\n      }\n    }\n\n    return origEmit.apply(this, arguments);\n  };\n}\n\nexports.wrapCallSite = wrapCallSite;\nexports.getErrorSource = getErrorSource;\nexports.mapSourcePosition = mapSourcePosition;\nexports.retrieveSourceMap = retrieveSourceMap;\n\nexports.install = function(options) {\n  options = options || {};\n\n  if (options.environment) {\n    environment = options.environment;\n    if ([\"node\", \"browser\", \"auto\"].indexOf(environment) === -1) {\n      throw new Error(\"environment \" + environment + \" was unknown. Available options are {auto, browser, node}\")\n    }\n  }\n\n  // Allow sources to be found by methods other than reading the files\n  // directly from disk.\n  if (options.retrieveFile) {\n    if (options.overrideRetrieveFile) {\n      retrieveFileHandlers.length = 0;\n    }\n\n    retrieveFileHandlers.unshift(options.retrieveFile);\n  }\n\n  // Allow source maps to be found by methods other than reading the files\n  // directly from disk.\n  if (options.retrieveSourceMap) {\n    if (options.overrideRetrieveSourceMap) {\n      retrieveMapHandlers.length = 0;\n    }\n\n    retrieveMapHandlers.unshift(options.retrieveSourceMap);\n  }\n\n  // Support runtime transpilers that include inline source maps\n  if (options.hookRequire && !isInBrowser()) {\n    var Module;\n    try {\n      Module = require('module');\n    } catch (err) {\n      // NOP: Loading in catch block to convert webpack error to warning.\n    }\n    var $compile = Module.prototype._compile;\n\n    if (!$compile.__sourceMapSupport) {\n      Module.prototype._compile = function(content, filename) {\n        fileContentsCache[filename] = content;\n        sourceMapCache[filename] = undefined;\n        return $compile.call(this, content, filename);\n      };\n\n      Module.prototype._compile.__sourceMapSupport = true;\n    }\n  }\n\n  // Configure options\n  if (!emptyCacheBetweenOperations) {\n    emptyCacheBetweenOperations = 'emptyCacheBetweenOperations' in options ?\n      options.emptyCacheBetweenOperations : false;\n  }\n\n  // Install the error reformatter\n  if (!errorFormatterInstalled) {\n    errorFormatterInstalled = true;\n    Error.prepareStackTrace = prepareStackTrace;\n  }\n\n  if (!uncaughtShimInstalled) {\n    var installHandler = 'handleUncaughtExceptions' in options ?\n      options.handleUncaughtExceptions : true;\n\n    // Provide the option to not install the uncaught exception handler. This is\n    // to support other uncaught exception handlers (in test frameworks, for\n    // example). If this handler is not installed and there are no other uncaught\n    // exception handlers, uncaught exceptions will be caught by node's built-in\n    // exception handler and the process will still be terminated. However, the\n    // generated JavaScript code will be shown above the stack trace instead of\n    // the original source code.\n    if (installHandler && hasGlobalProcessEventEmitter()) {\n      uncaughtShimInstalled = true;\n      shimEmitUncaughtException();\n    }\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../~/source-map-support/source-map-support.js\n// module id = 18\n// module chunks = 0 2","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 19\n// module chunks = 0 2","module.exports = require(\"module\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"module\"\n// module id = 20\n// module chunks = 0 2","module.exports = require(\"source-map\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"source-map\"\n// module id = 21\n// module chunks = 0 2","// CREATE TABLE course_user_is_learning (\n//   id SERIAL PRIMARY KEY,\n\n//   active BOOLEAN,\n\n//   course_id INTEGER REFERENCES course (id) ON DELETE CASCADE,\n//   user_id INTEGER REFERENCES \"user\" (id) ON DELETE CASCADE,\n//   unique (course_id, user_id)\n// );\n\nimport { select } from './select';\nimport { insert } from './insert';\nimport { update } from './update';\n\nexport { select, insert, update };\n\n\n\n// WEBPACK FOOTER //\n// ./components/coursesUserIsLearning/model/index.js","import { db } from '~/db/init.js';\n\nconst update = (problem, problemId) =>\n  db.one(\n    \"UPDATE problem SET content=${content} WHERE id=${id} RETURNING *\",\n    {\n      content: problem.content,\n      id: problemId\n    }\n  );\n\nconst destroy = (id) =>\n  db.none('delete from problem where id=${id}', { id });\n\nimport { insert } from './insert';\nimport { select } from './select';\n\nexport { insert, select, update, destroy };\n\n\n\n// WEBPACK FOOTER //\n// ./components/problems/model/index.js","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 24\n// module chunks = 0","import 'source-map-support/register';\nimport express from 'express';\n\n// load environment variables.\nimport '../env.js';\nconsole.log('node env: ' + process.env.NODE_ENV);\n\nconst app = express();\n\n\nimport { allowCrossDomain } from './middlewares/allowCrossDomain';\napp.use(allowCrossDomain);\n\nimport { stopPropagationForAssets } from './middlewares/stopPropagationForAssets';\napp.use(stopPropagationForAssets);\n\nimport bodyParser from 'body-parser';\napp.use(bodyParser.json()); // to support JSON-encoded bodies\n\nimport { staticAssets } from './middlewares/static';\napp.use(staticAssets);\n\n// routes\nimport { router as coursesRouter } from './components/courses/routes';\napp.use('/api/courses', coursesRouter);\n\nimport { router as problemsRouter } from './components/problems/routes';\napp.use('/api/problems', problemsRouter);\n\nimport { router as coursesUserIsLearningRouter } from './components/coursesUserIsLearning/routes';\napp.use('/api/coursesUserIsLearning', coursesUserIsLearningRouter);\n\n// GET routes that return results for particular frontend page. something like what server-rendering would do.\nimport { router as pagesRouter } from './components/pages/routes';\napp.use('/api/pages', pagesRouter);\n\nimport { router as authRouter } from './components/auth/routes';\napp.use('/api/auth', authRouter);\n\napp.get('*', (request, response) =>\n  response.send(\n    `\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n      <title>Memcode</title>\n      <link rel=\"stylesheet\" href=\"/styles.css\">\n      <link href=\"/index.css\" rel=\"stylesheet\">\n      <!-- to verify google webmasters -->\n      <meta name=\"google-site-verification\" content=\"Cv256pnTnFWM0T6qi3SXK1u1K-B6W7IJQ9JoOQ_1I_E\" />\n      <link rel=\"icon\" type=\"image/png\" href=\"/favicon-32x32.png\" sizes=\"32x32\" />\n      <link rel=\"icon\" type=\"image/png\" href=\"/favicon-16x16.png\" sizes=\"16x16\" />\n    </head>\n    <body>\n      <div id=\"root\"></div>\n      <script>\n        window.env = {\n          githubSignInLink: 'https://github.com/login/oauth/authorize?client_id=${process.env['GITHUB_OAUTH_ID']}'\n        };\n      </script>\n      <script type=\"text/javascript\" src=\"/index.js\"></script>\n    </html>\n    `\n  )\n);\n\n// because express needs to see there are 4 arguments to treat :error as error.\n// this middleware should also come last.\n// eslint-disable-next-line no-unused-vars\napp.use((error, req, res, next) => {\n  res.status(500).json({ error: error.message });\n});\n\n// process.env.PORT lets the port be set by Heroku\nconst port = process.env.PORT || 3000;\n\napp.listen(port, (err) => {\n  err ?\n  console.log(`server start error: ${err}`) :\n  console.log(`server is listening on port: ${port}`);\n});\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","module.exports = require(\"babel-polyfill\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = 26\n// module chunks = 0","import express from 'express';\nconst router = express.Router();\n\nimport jwt from 'jsonwebtoken';\nimport FormData from 'form-data';\nimport fetch from 'node-fetch';\nimport { catchAsync } from '~/services/catchAsync';\n\nimport * as User from '~/components/users/model';\n\n// 1. after user goes to github.com/login/oauth/authorize?client_id=OUR_ID, she is redirected here\nrouter.get('/github/callback', catchAsync(async (request, response) => {\n  // getting access token by sending github authorization code that will prove to github that it's indeed\n  // we are the application (client_id, client_secret) that user gave access to\n  const data = new FormData();\n  data.append('client_id', process.env['GITHUB_OAUTH_ID']);\n  data.append('client_secret', process.env['GITHUB_OAUTH_SECRET']);\n  data.append('code', request.query.code);\n\n  // 'access_token=0bc4d5757978a90d8e9bc96fac795c876179f2ba&scope=&token_type=bearer'\n  const stringWithAccessToken = await fetch('https://github.com/login/oauth/access_token', {\n    method: 'POST',\n    body: data\n  })\n    .then(res => (res.ok ? res.text() : Promise.reject(res)));\n\n  const accessToken = stringWithAccessToken.split('access_token=')[1].split('&scope')[0];\n\n  // fetching our profile info signed in as a user (access token)\n  const accountReturnedFromGithub = await fetch('https://api.github.com/user', {\n    headers: {\n      Authorization: `token ${accessToken}`\n    }\n  }).then(res => res.json());\n\n  // now that we are sure our user is this github's user, let's\n  const existingUser = await User.select.oneByOauth('github', accountReturnedFromGithub.id);\n  if (existingUser) { // user with this github_id is already in our db! sign in.\n    const token = jwt.sign(existingUser, process.env['JWT_SECRET']);\n    redirectWithToken(response, token);\n  } else { // no users with this id found! create such user and sign in.\n    const createdUser = await User.insert.createFromGithub(accountReturnedFromGithub);\n    const token = jwt.sign(createdUser, process.env['JWT_SECRET']);\n    redirectWithToken(response, token);\n  }\n}));\n\n// let's put token into header, so that we don't have to display the query string and the delete it\n// nope, because turns out we can't see headers on initial page load\nconst redirectWithToken = (response, token) =>\n  response.redirect('/?token=' + token);\n\nexport { router };\n\n\n\n// WEBPACK FOOTER //\n// ./components/auth/routes.js","import express from 'express';\nconst router = express.Router();\n\nimport { catchAsync } from '~/services/catchAsync';\nimport { authenticateMiddleware } from '~/middlewares/authenticate';\n\nimport * as Course from './model';\n\nrouter.get('/', catchAsync(async (request, response) => {\n  const courses = await Course.select.all();\n  response.status(200).json(courses);\n}));\n\n// => [{\n//   course: {},\n//   courseUserIsLearning: {},\n//   amountOfProblemsToReview: 3\n//   amountOfProblemsToLearn: 1\n// }], active, filtered by amount of due problems\nrouter.get('/allLearned', authenticateMiddleware, catchAsync(async (request, response) => {\n  const res = await Course.select.allLearned(request.currentUser.id);\n  response.status(200).json(res);\n}));\n\nrouter.get('/allCreated', authenticateMiddleware, catchAsync(async (request, response) => {\n  const res = await Course.select.allCreated(request.currentUser.id);\n  response.status(200).json(res);\n}));\n\n// move to /pages\nrouter.get('/:id', authenticateMiddleware, catchAsync(async (request, response) => {\n  const course = await Course.select.oneForActions(request.params.id, request.currentUser.id);\n  response.status(200).json(course);\n}));\n\nrouter.post('/', authenticateMiddleware, catchAsync(async (request, response) => {\n  const course = await Course.insert.create(request.body['course'], request.currentUser.id);\n\n  response.status(200).json(course);\n}));\n\nrouter.put('/:id', catchAsync(async (request, response) => {\n  await Course.update.update(request.params.id, request.body['course']);\n  response.status(200).json({});\n}));\n\nrouter.delete('/:id', catchAsync(async (request, response) => {\n  await Course.ddelete.destroyCourseWithProblems(request.params.id);\n  response.status(200).json({});\n}));\n\nexport { router };\n\n\n\n// WEBPACK FOOTER //\n// ./components/courses/routes.js","import { db } from '~/db/init.js';\n\nconst insert = {\n  create: async (courseId, userId) =>\n    db.one(\n      \"INSERT INTO course_user_is_learning \\\n      (active, course_id, user_id) VALUES \\\n      (true, ${courseId}, ${userId}) \\\n      RETURNING *\",\n      { courseId, userId }\n    )\n};\n\nexport { insert };\n\n\n\n// WEBPACK FOOTER //\n// ./components/coursesUserIsLearning/model/insert.js","import { db } from '~/db/init.js';\n\nconst select = {\n  oneByCourseIdAndUserId: (courseId, userId) =>\n    db.one(\n      `\n        SELECT *\n        FROM course_user_is_learning\n        WHERE course_id = \\${courseId} AND user_id = \\${userId}\n      `,\n      { courseId, userId }\n    ),\n\n  problemsToLearn: (id) =>\n    db.any(\n      `\n      SELECT *\n      FROM problem\n      WHERE problem.id NOT IN (\n        SELECT problem_user_is_learning.problem_id\n        FROM problem_user_is_learning\n        WHERE problem_user_is_learning.course_user_is_learning_id = \\${id}\n      )\n      AND problem.course_id = (\n        SELECT course_user_is_learning.course_id\n        FROM course_user_is_learning\n        WHERE course_user_is_learning.id = \\${id}\n      )\n      `,\n      { id }\n    ),\n\n  problemsToReview: (id) =>\n    db.any(\n      `\n      SELECT *\n      FROM problem\n      WHERE problem.id IN (\n        SELECT problem_user_is_learning.problem_id\n        FROM problem_user_is_learning\n        WHERE (\n          problem_user_is_learning.course_user_is_learning_id = \\${id}\n          AND\n          problem_user_is_learning.next_due_date < timezone('UTC', now())\n        )\n      )\n      `,\n      { id }\n    )\n};\n\nexport { select };\n\n\n\n// WEBPACK FOOTER //\n// ./components/coursesUserIsLearning/model/select.js","import { db } from '~/db/init.js';\n\nconst update = {\n  ifActive: (id, ifActive) =>\n    db.one(\n      \"UPDATE course_user_is_learning \\\n      SET active = ${active} \\\n      WHERE id = ${id} \\\n      RETURNING *\",\n      { active: ifActive, id }\n    )\n};\n\nexport { update };\n\n\n\n// WEBPACK FOOTER //\n// ./components/coursesUserIsLearning/model/update.js","import express from 'express';\nconst router = express.Router();\n\nimport { catchAsync } from '~/services/catchAsync';\nimport { authenticateMiddleware } from '~/middlewares/authenticate';\n\nimport * as CourseUserIsLearning from './model';\nimport * as ProblemUserIsLearning from '~/components/problemsUserIsLearning/model';\n\nrouter.post('/', authenticateMiddleware, catchAsync(async (request, response) => {\n  const courseUserIsLearning = await CourseUserIsLearning.insert.create(request.body['courseId'], request.currentUser.id);\n  response.status(200).json(courseUserIsLearning);\n}));\n\nrouter.put('/:id/resumeLearning', catchAsync(async (request, response) => {\n  const courseUserIsLearning = await CourseUserIsLearning.update.ifActive(request.params['id'], true);\n  response.status(200).json(courseUserIsLearning);\n}));\n\nrouter.put('/:id/stopLearning', catchAsync(async (request, response) => {\n  const courseUserIsLearning = await CourseUserIsLearning.update.ifActive(request.params['id'], false);\n  response.status(200).json(courseUserIsLearning);\n}));\n\nrouter.put('/:id/problems/:problemId/review', authenticateMiddleware, catchAsync(async (request, response) => {\n  await ProblemUserIsLearning.update.review(\n    request.params['id'],\n    request.params['problemId'],\n    request.body['performanceRating']\n  );\n  response.status(200).json({});\n}));\n\n// needs courseUserIsLearningId, problemId\nrouter.post('/:id/problems/:problemId/learn', authenticateMiddleware, catchAsync(async (request, response) => {\n  await ProblemUserIsLearning.insert.create(\n    request.params['id'],\n    request.params['problemId']\n  );\n  response.status(200).json({});\n}));\n\nexport { router };\n\n\n\n// WEBPACK FOOTER //\n// ./components/coursesUserIsLearning/routes.js","// we are putting all per-page get routes here, because they don't really tend to belong to certain components.\n// for the single page we may want to fetch may things, for example: course, courseUserIsLearning, and problems.\n// we will only want GET routes here, as deletes and updates tend to only concern one component at a time.\nimport express from 'express';\nconst router = express.Router();\n\nimport { catchAsync } from '~/services/catchAsync';\nimport { authenticateMiddleware } from '~/middlewares/authenticate';\n\nimport * as CourseUserIsLearning from '~/components/coursesUserIsLearning/model';\nimport * as Course from '~/components/courses/model';\nimport * as Problem from '~/components/problems/model';\n\nrouter.get('/courses/:id/learn', authenticateMiddleware, catchAsync(async (request, response) => {\n  const courseId = request.params['id'];\n\n  const courseUserIsLearning = await CourseUserIsLearning.select.oneByCourseIdAndUserId(courseId, request.currentUser.id);\n  const problems = await CourseUserIsLearning.select.problemsToLearn(courseUserIsLearning.id);\n\n  response.status(200).json({ courseUserIsLearning, problems });\n}));\n\nrouter.get('/courses/:id/review', authenticateMiddleware, catchAsync(async (request, response) => {\n  const courseId = request.params['id'];\n\n  const courseUserIsLearning = await CourseUserIsLearning.select.oneByCourseIdAndUserId(courseId, request.currentUser.id);\n  const problems = await CourseUserIsLearning.select.problemsToReview(courseUserIsLearning.id);\n\n  response.status(200).json({ courseUserIsLearning, problems });\n}));\n\nrouter.get('/courses/:id/edit', authenticateMiddleware, catchAsync(async (request, response) => {\n  const courseId = request.params['id'];\n\n  const course = await Course.select.oneById(courseId);\n  const problems = await Problem.select.allByCourseId(courseId);\n\n  response.status(200).json({ course, problems });\n}));\n\nrouter.get('/courses/:id', authenticateMiddleware, catchAsync(async (request, response) => {\n  const courseId = request.params['id'];\n\n  const course = await Course.select.oneById(courseId);\n  const problems = await Problem.select.allByCourseId(courseId);\n\n  response.status(200).json({ course, problems });\n}));\n\nexport { router };\n\n\n\n// WEBPACK FOOTER //\n// ./components/pages/routes.js","import { db } from '~/db/init.js';\n\nconst insert = {\n  // we don't need to create problem_user_is_learning for every user who learns this course, because problem_user_is_learning is only for already learnt problems\n  create: (problem) =>\n    db.one(\n      \"INSERT INTO problem (type, content, course_id, created_at) VALUES (${type}, ${content}, ${courseId}, ${created_at}) RETURNING *\",\n      {\n        type: problem.type,\n        content: problem.content,\n        courseId: problem.courseId,\n        created_at: new Date()\n      }\n    )\n};\n\nexport { insert };\n\n\n\n// WEBPACK FOOTER //\n// ./components/problems/model/insert.js","import { db } from '~/db/init.js';\n\nconst select = {\n  allByCourseId: (courseId) =>\n    db.any(\n      'SELECT * FROM problem WHERE course_id = ${courseId} ORDER BY created_at',\n      { courseId }\n    )\n};\n\nexport { select };\n\n\n\n// WEBPACK FOOTER //\n// ./components/problems/model/select.js","import express from 'express';\nconst router = express.Router();\n\nimport { catchAsync } from '~/services/catchAsync';\nimport * as Problem from './model';\n\nrouter.post('/', catchAsync(async (request, response) => {\n  const createdProblem = await Problem.insert.create(request.body['problem']);\n  response.status(200).json(createdProblem);\n}));\n\nrouter.put('/:id', catchAsync(async (request, response) => {\n  const updatedProblem = await Problem.update(request.body['problem'], request.params['id']);\n  response.status(200).json(updatedProblem);\n}));\n\nrouter.delete('/:id', catchAsync(async (request, response) => {\n  await Problem.destroy(request.params['id']);\n  response.status(200).json({});\n}));\n\nexport { router };\n\n\n\n// WEBPACK FOOTER //\n// ./components/problems/routes.js","// CREATE TABLE problem_user_is_learning (\n//   id SERIAL PRIMARY KEY,\n//\n//   is_learned BOOLEAN,\n//\n//   easiness SMALLINT, [A number  1.3 representing how easy the item is, with 1.3 being the hardest.  Defaults to 2.5]\n//\n//   consecutive_correct_answers SMALLINT, [How many times in a row the user has correctly answered this item]\n//\n//   nextDueDate TIMESTAMP, [The next time this item needs to be reviewed]\n//\n//   problem_id INTEGER REFERENCES problem (id) ON DELETE CASCADE,\n//   user_id INTEGER REFERENCES \"user\" (id) ON DELETE CASCADE,\n//   unique (problem_id, user_id)\n// );\n\n\nimport { db } from '~/db/init.js';\n\nimport { initialScore } from '../services/initialScore';\nimport { getNextScore } from '../services/getNextScore';\n\nconst select = {\n  findByCuilIdAndProblemId: async (cuilId, problemId) =>\n    db.one(\n      `SELECT * FROM problem_user_is_learning\n      WHERE course_user_is_learning_id = \\${cuilId} AND problem_id = \\${problemId}`,\n      { cuilId, problemId }\n    )\n};\n\nconst update = {\n  // solve particular problem\n  // performanceRating: 0-5\n  review: async (courseUserIsLearningId, problemId, performanceRating) => {\n    const me = await select.findByCuilIdAndProblemId(courseUserIsLearningId, problemId);\n\n    // was easiness was NAN once?\n    console.log('________________________')\n    console.log({me})\n    console.log('__________________________')\n    const nextScore = getNextScore(me.easiness, me.consecutiveCorrectAnswers, performanceRating);\n    console.log({nextScore})\n    console.log('__________________')\n\n    return db.one(\n      `\n      UPDATE problem_user_is_learning\n      SET easiness = \\${easiness},\n          consecutive_correct_answers = \\${consecutiveCorrectAnswers},\n          next_due_date = timezone('UTC', (now() + '${nextScore.daysToNextReview} days'::INTERVAL))\n      WHERE id = \\${id}\n      RETURNING *\n      `,\n      {\n        easiness: nextScore.easiness,\n        consecutiveCorrectAnswers: nextScore.consecutiveCorrectAnswers,\n        id: me.id\n      }\n    );\n  },\n};\n\nconst insert = {\n  create: (courseUserIsLearningId, problemId) =>\n    db.one(\n      `\n      INSERT INTO problem_user_is_learning\n      (easiness, consecutive_correct_answers, next_due_date, course_user_is_learning_id, problem_id) VALUES\n      (\\${easiness}, \\${consecutiveCorrectAnswers}, timezone('UTC', now()), \\${courseUserIsLearningId}, \\${problemId})\n      RETURNING *\n      `,\n      {\n        easiness: initialScore().easiness,\n        consecutiveCorrectAnswers: initialScore().consecutiveCorrectAnswers,\n        courseUserIsLearningId,\n        problemId\n      }\n    )\n};\n\nexport { insert, update };\n\n\n\n// WEBPACK FOOTER //\n// ./components/problemsUserIsLearning/model/index.js","const allowCrossDomain = (req, res, next) => {\n  res.status(200);\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\n  res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n  next();\n};\n\nexport { allowCrossDomain };\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/allowCrossDomain.js","// (global routes, because path.join didn't work after update to webpacked ES6)\n// serves index.js, index.css.\nimport express from 'express';\nimport path from 'path';\n\nconst staticAssets = express.static(\n  path.join(__dirname, '../..', '/frontend/webpacked'),\n);\n\nexport { staticAssets };\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/static.js","// https://github.com/jaredhanson/passport/issues/14#issuecomment-21863553\nconst stopPropagationForAssets = (req, res, next) => {\n  if (req.url !== '/favicon.ico' && req.url !== '/styles.css') {\n    return next();\n  } else {\n    res.status(200);\n    res.header('Cache-Control', 'max-age=4294880896');\n    res.end();\n  }\n};\n\nexport { stopPropagationForAssets };\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/stopPropagationForAssets.js","// When you require('env.js') because this isnt wrapped in a module.exports (on purpose), the code is literally executed and thus the variables are added to your environment\n// http://thewebivore.com/super-simple-environment-variables-node-js/\n\n// to change them, go to https://github.com/settings/applications/505783.\nprocess.env['GITHUB_OAUTH_ID'] = \"b4f6fd40a2b6401dc1b2\";\nprocess.env['GITHUB_OAUTH_SECRET'] = \"016cdc9ce2711937c92921f606965d09de545ad0\";\nprocess.env['JWT_SECRET'] = 'lamlalamkflre';\n\n// postgres db\n// 0245328cb03fe9c577709aca77614b1743e9735fa510fecbd98bf4c3ef9f0afa\n\n\n\n// WEBPACK FOOTER //\n// ../env.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 45\n// module chunks = 0","module.exports = require(\"form-data\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"form-data\"\n// module id = 46\n// module chunks = 0","module.exports = require(\"node-fetch\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"node-fetch\"\n// module id = 47\n// module chunks = 0"],"sourceRoot":""}